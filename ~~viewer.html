<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>30-Second Viewer</title>
	<meta name="description" content="This is an attempt to locally mimic the functionality of the 30-Second Exercise Flash app from Posemaniacs.com" />
	<meta name="author" content="Pharan">

	<style type="text/css">
		body {					/* with totally badass image embedding */
			font-family:		"Open Sans", "Inter UI", "San Francisco", "Segue UI", "Helvetica", "Arial", sans-serif;
			background-image:	url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAIAAACRXR/mAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkRDQjI4M0JGRUY3ODExRTFCOERFQzUwMUE2MUE2MUJFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkRDQjI4M0MwRUY3ODExRTFCOERFQzUwMUE2MUE2MUJFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RENCMjgzQkRFRjc4MTFFMUI4REVDNTAxQTYxQTYxQkUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RENCMjgzQkVFRjc4MTFFMUI4REVDNTAxQTYxQTYxQkUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6gMo0pAAAHOUlEQVR42myZWXbiQBAE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);
		}
		
		/* transitions */
		#welcome, #welcome.helpon, #welcome.helpoff,
		#leftarrow,
		#rightarrow,
		#arrowholder,
		header
		{
			-moz-transition:		all .3s cubic-bezier(.5, .01, .1, 1.00);
			-webkit-transition:		all .3s cubic-bezier(.5, .01, .1, 1.00);
			-o-transition:			all .3s cubic-bezier(.5, .01, .1, 1.00);
			transition:				all .3s cubic-bezier(.5, .01, .1, 1.00);
		}
		/* shadows */
		#leftarrow,
		#rightarrow
		{
			text-shadow: 	0px -1px 0px #bbb;
			filter: 		dropshadow(color=#bbb, offx=0, offy=-1);
		}

		/* unselectables */
		#leftarrow,
		#rightarrow,
		#imageholder,
		#timeleft
		{
			user-select:	 		none;
			-moz-user-select:		none;
			-webkit-user-select:	none;
		}
		
		/*	*	*	HEADER	*	*	*/
		#usersecondsbox, header h1 {
			font-family: 	"Open Sans Light", "Segoe UI Light", "Museo Sans 500", "Gotham Book", "Open Sans", "Trebuchet", "Helvetica", "Arial", sans-serif;
			font-size:		30px;
			font-weight: 	normal;
			color:			#777;
		}
		#usersecondsbox {
			text-align:				right;
			border:					1px solid transparent;
			background-color:		transparent;
		}
		#usersecondsbox::selection {			background-color:		#bcc;		}
		#usersecondsbox::-moz-selection {		background-color:		#bcc;		}
		#usersecondsbox:hover {
			border:					1px solid #ccc;
		}
		#usersecondsbox:focus {
			border:					1px solid #ccc;
			background-color:		#fafafa;
		}
		header h1 {
			display:			inline;
			line-height: 		1em;
			margin: 			0px;
			margin-left:		-2px;
			padding:			0px;
		}
		header {
			position:			fixed;
			bottom: 			-15px;
			left: 				20px;
			background-color: 	rgba(255,255,255,0.3);
			border: 			#ccc solid 1px;
			padding:			20px 20px;
			opacity:			.8;
		}
		header:hover {
			background-color: 	rgba(255,255,255,0.5);
			padding:			30px 20px;
			opacity: 			1.0;
			bottom: 			-8px;
		}
		#tgh {
			font-size:			10px;
			color:				#aaa;
			margin: 			0px 1em;
		}
		#fileinput {
			color: 				#ccc;
		}
		#overallholder {
			position: 			fixed;
			top: 				50px;
			width: 				100%;
			margin: 			0px;
			padding: 			0px;
		}
		
		/*	*	*	ARROWS	*	*	*/
		#arrowholder {
			width: 				350px;
			margin-left: 		-175px;
			position: 			fixed;
			left: 				50%;
			top: 				-1px;
		}
		
		#leftarrow,
		#rightarrow
		{
			/*position and size*/
			position: 			absolute;
			top: 				-10px;
			font-size: 			50px;
			width: 				80px;
			height: 			60px;
			text-align: 		center;
			
			/*styling*/
			cursor: 			pointer;
			color: 				#f6f6f6;
		}
		#leftarrow:hover,
		#rightarrow:hover
		{
			background-color: rgba(255,255,255,0.2);
		}
		#leftarrow	{	left:	10px;		}
		#rightarrow	{	right:	10px;		}

		#timeleft {
			position: 			absolute;
			font-size: 			20px;
			top: 				15px;
			color: 				#bbb;
			left: 				50%;
			margin-left: 		-80px;
			width: 				150px;
			height: 			50px;
			line-height:		0.3em;
		}

		/*	*	*	IMAGE HOLDER	*	*	*/
		#imageholder {
			position: 			relative;
			min-width: 			50px;
			min-height: 		50px;
			margin:				0px auto;
			text-align: 		center;
		}
		#imagecaption {
			color:				#ccc;
			font-size:			14px;
		}
		#imagecaption:hover {
			color: 				#bbb;
		}
		#image {
			position:			relative;
			max-height:			800px;
			margin:				0px auto;
			padding: 			0px;
		}
		#image.fullsize {
			max-height:			none;
		}
		
		
		/*	*	*	WELCOME MESSAGE		*	*	*/
		#welcome, #welcome.helpon {
			font-size: 		12px;
			color: 			#777;
			padding:		1.5em;
			overflow:		hidden;
			text-align:		justify;
		}
		#welcome.helpoff {
			height: 		0px;
			width: 			200px;
			padding: 		0px;
		}
		#welcome.helpon	{
			height:			auto;
			width: 			400px;
			margin-top:		8px;
			padding-top:	3px;
			
			border-top:		1px dotted #bbb;
		}
		#welcome.helpon p {
			margin-top: 5px;
		}
		#welcome.helpoff p {
			margin-top: -5px;
		}
		ol {
			padding-left: 	20px;
			text-align: 	left;
		}
		
		/*	*	*	*	FILE CHOOSER	*	*	*	*/
		#fileinput {
			margin-left:	5px;
		}
	</style>
	
	<script type="text/javascript">	
	const THE_IMAGE_ID = "image";
	const THE_IMAGECAPTION_ID = "imagecaption";
	const WELCOME_ID = "welcome";
	const USER_CLICKABLE_NUMBER_ID = "usersecondsbox";
	const MENTIONS_OF_SECONDS_CLASS = "numsec";
	const TIMELEFT_ID = "timeleft";
	const TGH_ID = "tgh";
	const PLAYPAUSE_ID = "playpause";
	const LEFTARROW_ID = "leftarrow";
	const RIGHTARROW_ID = "rightarrow";
	const IMAGEHOLDER_ID = "imageholder";

	const LEFTARROW_UNICODE = "&lsaquo;";
	const RIGHTARROW_UNICODE = "&rsaquo;";
	const PLAYBUTTON_UNICODE = "&#9654;";
	const PAUSEBUTTON_UNICODE = "&#9208;";

	var MENTIONS_OF_SECONDS_SELECTOR = "." + MENTIONS_OF_SECONDS_CLASS;

	const DEFAULT_SECONDS = 30;
	const KEY_ENTER = 13;
	const KEY_LEFT = 37;
	const KEY_RIGHT = 39;
	const KEY_PLAYPAUSE = 32;

	var REST_OF_TITLE = "-Second Viewer";
	var theFileArray = 0;
	var viewHelp = false;
	

	var VIEWER_FILENAME = function() {
		var url = document.location.href;
		url = url.substring(0, (url.indexOf("#") == -1) ? url.length : url.indexOf("#"));
		url = url.substring(0, (url.indexOf("?") == -1) ? url.length : url.indexOf("?"));
		url = url.substring(url.lastIndexOf("/") + 1, url.length);
		return url;
	}();



	document.addEventListener('DOMContentLoaded', function() {
		if (window.File && window.FileReader && window.FileList && window.Blob) {	//check for file-reader compatibility
			localizeText();
			initButtons();
		} else {
			alert('The File APIs are not fully supported by your browser.');
		}

		function initButtons() {
			//bind click events
			// These need to be anonymous functions so they don't break the subsequent invisible -this- parameter during function dereferencing
			document.getElementById(RIGHTARROW_ID).addEventListener('click', () => { circulator.forceNext(); } );
			document.getElementById(LEFTARROW_ID).addEventListener('click', () => { circulator.forcePrevious(); } );
			document.getElementById(IMAGEHOLDER_ID).addEventListener('click', () => { imageHolder.toggleImageZoom(); } );
			
			//bind event for when user changes files
			var fileInputElement = document.getElementById("fileinput");
			fileInputElement.setAttribute("accept", "image/*");
			fileInputElement.addEventListener("change", () => {
				listData.newFileArray();
				//FIXME: refresh current image. It breaks when selecting a new image set after a previous set has already started.
			});			
			
			//bind custom-time textbox event
			var clickableNumberElement = document.getElementById(USER_CLICKABLE_NUMBER_ID);
			
			clickableNumberElement.addEventListener("click", () => {
				clickableNumberElement.focus();
				clickableNumberElement.select();
			});

			clickableNumberElement.addEventListener("keydown", function(event) {
				var valToCheck =  parseInt(clickableNumberElement.value, 10);
				
				//TODO set new time only if textbox is a valid number
				//TODO do active checking while textbox is being edited (add change listener)
				//TODO apply changes and reset timer when user presses enter in textbox

				// when you press enter
				if (event.keyCode === KEY_ENTER) {	
					event.preventDefault();
					clickableNumberElement.blur();		// lose focus on textbox
					
					// TODO: Move this to a separate validate() method.
					//check if valToCheck is a valid value
					if(	isNaN(valToCheck) ) {
						clickableNumberElement.value = DEFAULT_SECONDS;	// if it's an invalid value, reset to default (30)
					}
					else if( valToCheck < circulator.MINIMUM_SECONDS ) {
						clickableNumberElement.value = circulator.MINIMUM_SECONDS;
					}
					

					////at this point, the number in USER_CLICKABLE_NUMBER should be valid.
					var validnumber = clickableNumberElement.value;			// change text of site to reflect user change:
					changeAllMentionOfSeconds(validnumber);
					
					if( listData.isPopulated() ) {					// only trigger new duration if the list is populated
						circulator.newDuration();
					}
					
				}
			});
			
			//bind left and right keys
			document.addEventListener("keydown", (event) => {
				if (event.keyCode === KEY_LEFT)			{ circulator.forcePrevious();	}
				if (event.keyCode === KEY_RIGHT)		{ circulator.forceNext(); 		}
				if (event.keyCode === KEY_PLAYPAUSE)	{ circulator.togglePlayPause();	}
			});

		}

		function localizeText() {
			if (Math.floor((Math.random() * 50)) == 20) REST_OF_TITLE = "-Second Hamburger";	//proc hamburger

			var secondsSetting = document.getElementById(USER_CLICKABLE_NUMBER_ID).value;
			
			changeAllMentionOfSeconds(secondsSetting);
			document.getElementById(LEFTARROW_ID).innerHTML = LEFTARROW_UNICODE;
			document.getElementById(RIGHTARROW_ID).innerHTML = RIGHTARROW_UNICODE;
			//document.getElementById(PLAYPAUSE_ID).innerHTML = PLAYBUTTON_UNICODE;

			document.querySelectorAll("header > h1").forEach((el) => { el.innerHTML = REST_OF_TITLE; });
			document.querySelectorAll(".viewerfilename").forEach((el) => { el.innerHTML = VIEWER_FILENAME; });
			
			var WARNING_TITLES = ["ACHTUNG!", "CAUTION!", "ATTENTION!", "WARNING!", "DESU DESU!!", "ADVERTENCIA!"];
			var titlerand = Math.floor((Math.random() * WARNING_TITLES.length))
			document.getElementById("warningtitle").innerHTML = WARNING_TITLES[titlerand];
			
			var welcomeClassList = document.getElementById(WELCOME_ID).classList;
			welcomeClassList.add("helpon");
			welcomeClassList.remove("helpoff");
		}
	});

	var initImage = function() {
		imageHolder.toggleImageZoom();
		circulator.reflectChange();
	};
	var refreshSubHeader = function() {
		document.getElementById(TGH_ID).innerHTML = "[ " + listData.toString() + " : <span class='" + MENTIONS_OF_SECONDS_CLASS  + "'>" +  circulator.lastsecondsBetween + "</span> seconds each ]";
		var welcomeClassList = document.getElementById(WELCOME_ID).classList;
		welcomeClassList.remove("helpon");
		welcomeClassList.add("helpoff");
	};
	var changeAllMentionOfSeconds = function(numofseconds) {
		document.getElementById(USER_CLICKABLE_NUMBER_ID).value = numofseconds;
		document.querySelector("title").innerHTML = numofseconds + REST_OF_TITLE;		
		document.querySelectorAll(MENTIONS_OF_SECONDS_SELECTOR).forEach((el) => { el.innerHTML = numofseconds; });
	}
		

	// *		*		*		*		*		 CIRCULATOR OBJECT 			*		*		*		*		* 
	var circulator = {
		currentImage: "",
		isActive: true,
		currentNumber: 0,
		secondsLeft: 30,
		lastsecondsBetween: 30,
		secondsBetween: 30,
		MINIMUM_SECONDS: 5,
		counter: 0,
		
		dotRepresentation: (timeinSeconds, maxtime) => {
			var dotstring = "";
			var numofdots = timeinSeconds/maxtime * 90;
			for(var rrr = 0; rrr < numofdots; rrr++) {
				dotstring = dotstring + ".";
				if( (rrr + 1) % 30 == 0 && rrr != 0) dotstring += "<br />";
			}
			return dotstring;
		},
		
		togglePlayPause: function() {
			this.isActive = !(this.isActive);
			// TODO: Make time left indicator clickable
			// TODO: Make dots turn red when paused
			// TODO: Make play pause symbol visible when you hover over the dots (or the arrows?)
			// TODO: make play symbol always visible when paused.
		},
		
		updateTime: function() {
			if (this.isActive) {
				this.secondsLeft -= 0.5;
				if(this.secondsLeft < 0) {
					this.resetTimer();
					this.next();
				}
				this.updateTimeIndicator();
			}
		},
		updateTimeIndicator: function() {
			imageHolder.showTimeLeft(  this.dotRepresentation(this.secondsLeft, this.lastsecondsBetween)  );
		},
		initTimer: function() {
			this.resetTimer();
			
			clearInterval(this.counter);				//stop the previous counter (if it exists?)
			this.counter = setInterval(	() => {	circulator.updateTime(); },
										500
										);
		},
		resetTimer: function() {
			this.readTextBoxTime();
			this.lastsecondsBetween 	= this.secondsBetween;
			this.secondsLeft 			= this.secondsBetween;
		},
		readTextBoxTime: function() {
			var sec = parseInt( document.getElementById(USER_CLICKABLE_NUMBER_ID).value, 10 );
			this.secondsBetween	= sec;
		},
		reflectChange: function() {
			var x = this.currentNumber;
			var y = this.theOrder[ x ];
			currentImage = listData.fileNameArray[y];
			imageHolder.setImage( currentImage );
		},
		
		newDuration: function() {
			this.resetTimer();
			this.updateTimeIndicator();
		},
		forceNext: function() {
			if( listData.isPopulated() ) {
				this.next();
				this.newDuration();
			}
		},
		forcePrevious: function() {
			if( listData.isPopulated() ) {
				this.prev();
				this.newDuration();
			}
		},
		next: function() {
			if (this.currentNumber < listData.fileNameArray.length - 1) this.currentNumber++;
			else this.currentNumber = 0;
			this.reflectChange();
		},
		prev: function() {
			if (this.currentNumber > 0) this.currentNumber--;
			else this.currentNumber = listData.fileNameArray.length - 1;
			this.reflectChange();	
		},

		// SHUFFLE	(uses an array of ints from 0 to the last index of the data array)
		theOrder: [],
		newOrder: function() {
			this.initTheOrder();
			this.shuffleTheOrder();
			initImage();
		},
		initTheOrder: function() {
			this.theOrder = new Array(listData.fileNameArray.length);
			for(var qq = 0; qq < this.theOrder.length; qq++) {
				this.theOrder[qq] = qq;
			}
		},
		shuffleTheOrder: function() {
			var iterations = Math.floor(this.theOrder.length * 2 / 3);
			for(var xx = 0; xx < iterations; xx++) {
				var swapBuffer = this.theOrder[xx];
				var swapPartner = Math.floor((Math.random() * this.theOrder.length)); 
				this.theOrder[xx] = this.theOrder[swapPartner];
				this.theOrder[swapPartner] = swapBuffer;
			}
		},
	};
	
	// *		*		*		*		*		 IMAGE HOLDER OBJECT 		*		*		*		*		*
	var imageHolder = {
		isImageZoomed: true,
		setImage: function(filename) {
			var imageElement = document.getElementById(THE_IMAGE_ID);
			imageElement.setAttribute("src", "" + filename);
			var imagecaption = imageElement.getAttribute("src");
			document.getElementById(THE_IMAGECAPTION_ID).innerHTML = imagecaption;
		},
		showTimeLeft: function(timeString) {
			document.getElementById(TIMELEFT_ID).innerHTML = timeString;
		},
		toggleImageZoom: function() {
			this.isImageZoomed
		= !this.isImageZoomed;
			var imageElement = document.getElementById(THE_IMAGE_ID);

			if(this.isImageZoomed) {
				imageElement.style.maxHeight = "none";
			}
			else if(!this.isImageZoomed) {
				var targetHeight = window.innerHeight - 100;
				imageElement.style.maxHeight = targetHeight + "px";
			}
		}
	};

	// *		*		*		*		*		 LIST DATA OBJECT 			*		*		*		*		*
	var listData = {
		theListFile: "",
		fileNameArray: [],
		newFileArray: function() {
			theFileArray = document.getElementById("fileinput").files;		// take the files array from the <input> tag

			// Copy the filenames from the file array
			this.fileNameArray = new Array(theFileArray.length);
			for (var i = 0; i < theFileArray.length; i++) {
				this.fileNameArray[i] = theFileArray[i].name;
			}
			
			circulator.newOrder();
			circulator.initTimer();
			refreshSubHeader();
		},
		showList: function () {
			document.getElementById(TGH_ID).innerHTML = this.toString();
		},
		isPopulated: function() {
			return (listData.fileNameArray.length > 1);
		},
		toString: function() {
			return this.fileNameArray.length + " images"; 
		}
	};	
	</script>
</head>
	<body>
		<div id="overallholder">					
			<div id="imageholder" ><div id="imagecaption"> </div><img src="" id="image" /></div>
		</div>
		<header>
			<input type="text" size="1" value="30" id="usersecondsbox" /><h1> </h1>
			<div id="welcome" class="helpoff">
				<p>This is Pharan's <span class="numsec">30</span>-Second Viewer, a <a href="http://en.wikipedia.org/wiki/Gesture_drawing">gesture drawing</a> training tool
					for helping artists hone their perceptual skills in terms of identifying
					overall shapes and quickly analyzing the components of shapes/poses
					that best contribute to the expression of a feeling, movement, action and/or of realism.<br/>
					You can load image files and it will pick out and display a random image from the set every <span class="numsec">30</span> seconds.</p>
				<p><strong id="warningtitle">WARNING!</strong><br />
					Unfortunately, this current version has some severe limitations resulting in an annoying way to load files
					due to the way current browsers handle local file access.</p>
				<p> As a workaround, this is currently how to open a set of images:</p>
				<ol>
					<li>Copy this file (<span class="viewerfilename"></span>) into the folder where you have your image files.</li>
					<li>Open this file (<span class="viewerfilename"></span>), or double-click on it in Finder/Explorer/File Manager to automatically open it in your default browser</li>
					<li>Click on file browser below this text.</li>
					<li>Browse to the <strong>folder where you saved "<span class="viewerfilename"></span>".</strong></li>
					<li>Select all the images you want in that folder and click "Open".</li>
				</ol>
			</div>
			<p id="tgh"> </p>
			<input type="file" id="fileinput" multiple />	
		</header>
		<nav id="arrowholder">
			<div id="leftarrow"> </div>
			<div id="timeleft"> </div>
			<div id="rightarrow"> </div>
		</nav>
	</body>
</html>
